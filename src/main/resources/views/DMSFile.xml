<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_7.0.xsd">

  <form name="dms-file-form" id="portal-dms-file-form" title="Document"
    model="com.axelor.dms.db.DMSFile" extension="true">
    <extend target="//panel[@name='tagsPanel']">
      <insert position="after">
        <panel name="portalPanel" sidebar="true">
          <button onClick="save,action-portal-dms-file-method-update-children"
            name="updateChildrenBtn" title="Apply to children"/>
          <field name="author"/>
          <field name="workspaceSet" widget="TagSelect"/>
          <field name="isPrivate"/>
          <field name="permissionSelect"/>
          <field name="colorSelect" widget="SingleSelect"/>
          <field name="partnerSet" widget="TagSelect" showIf="isPrivate"/>
          <field name="partnerCategorySet" widget="TagSelect" showIf="isPrivate"/>
          <field name="image" widget="Image" colSpan="12" showTitle="false"
            onChange="action-portal-dms-file-record-create-thumbnail-image"/>
          <field name="description"/>
          <field name="thumbnailImage" hidden="true" colSpan="12"/>
        </panel>
      </insert>
    </extend>
  </form>

  <form name="dms-folder-form" id="portal-dms-folder-form" title="Directory"
    model="com.axelor.dms.db.DMSFile" extension="true">
    <extend target="//panel[@name='Overview']/*[last()]">
      <insert position="after">
        <button onClick="save,action-portal-dms-file-method-update-children"
          name="updateChildrenBtn" title="Apply to children"/>
        <field name="workspaceSet" widget="TagSelect"/>
        <field name="isPrivate"/>
        <field name="permissionSelect"/>
        <field name="colorSelect" widget="SingleSelect"/>
        <field name="partnerSet" widget="TagSelect" showIf="isPrivate"/>
        <field name="partnerCategorySet" widget="TagSelect" showIf="isPrivate"/>
        <field name="image" widget="Image" colSpan="12" showTitle="false"
          onChange="action-portal-dms-file-record-create-thumbnail-image"/>
        <field name="description"/>
        <field name="thumbnailImage" hidden="true" colSpan="12"/>
      </insert>
    </extend>
  </form>

  <action-method name="action-portal-dms-file-method-update-children">
    <call class="com.axelor.apps.portal.web.DMSFileController" method="updateChildren"/>
  </action-method>

  <action-record name="action-portal-dms-file-record-create-thumbnail-image"
    model="com.axelor.dms.db.DMSFile">
    <field name="thumbnailImage"
      expr="call: com.axelor.apps.portal.utils.ImageUtils:createThumbnail(image)"/>
  </action-record>

</object-views>